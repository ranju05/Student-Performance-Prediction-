<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function deleteUser(id) {
            fetch(`/admin/delete_user/${id}`, { method: 'DELETE' })
                .then(res => res.json())
                .then(data => location.reload());
        }

        function deletePrediction(id) {
            fetch(`/admin/delete_prediction/${id}`, { method: 'DELETE' })
                .then(res => res.json())
                .then(data => location.reload());
        }
    </script>
</head>
<body>
    <div class="navbar">
        <h2>Admin Dashboard</h2>
        <div class="nav-links">
            <a href="{{ url_for('home') }}">Home</a>
            <a href="{{ url_for('logout') }}">Logout</a>
        </div>
    </div>

    <div class="container">
        <h1>All Students</h1>
        <table border="1">
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Action</th>
            </tr>
            {% for user in users %}
            <tr>
                <td>{{ user[0] }}</td>
                <td>{{ user[1] }}</td>
                <td><button onclick="deleteUser('{{ user[0] }}')">Delete</button>
</td>
            </tr>
            {% endfor %}
        </table>

        <h1>Predictions</h1>
        <table border="1">
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Attendance</th>
                <th>Internal Marks</th>
                <th>Prediction</th>
                <th>Action</th>
            </tr>
            {% for row in predictions %}
            <tr>
                <td>{{ row[0] }}</td>
                <td>{{ row[1] }}</td>
                <td>{{ row[2] }}%</td>
                <td>{{ row[3] }}%</td>
                <td>{{ row[4] }}%</td>
                <td><button onclick="deleteUser('{{ user[0] }}')">Delete</button>
</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    <script>
    function deleteUser(id) {
        fetch(`/admin/delete_user/${id}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            location.reload();
        })
        .catch(error => console.error('Error:', error));
    }

    function deletePrediction(id) {
        fetch(`/admin/delete_prediction/${id}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            location.reload();
        })
        .catch(error => console.error('Error:', error));
    }
</script>


</body>
</html>
